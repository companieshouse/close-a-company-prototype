{% extends "layouts/main.html" %}

{% block pageTitle %}
  Provide directors' emails – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block beforeContent %}
  {{ govukBackLink({
    text: "Back",
    href: "javascript:window.history.back()"
  }) }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">

      <form action="/V3/provide-corporate-directors-emails" method="post">

        <h1 class="govuk-heading-xl">
          Provide directors' email addresses
        </h1>

        {% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
        {{ govukWarningText({
          text: "Please provide accurate email addresses to ensure directors receive the signing invitations.",
          iconFallbackText: "Warning"
        }) }}

        <p class="govuk-hint">
          We'll email each director you've selected to ask them to sign the application online.
        </p>

        {% from "govuk/components/input/macro.njk" import govukInput %}
        {% from "govuk/components/details/macro.njk" import govukDetails %}

        {# Loop through the directors selected on the previous screen #}
        {% for director in data.whichDirectorsWillBeSigningTheApplication %}

          {% set displayName =
            director
              | replace("JaneDoe", "DOE, Jane")
              | replace("SaraFrancis", "FRANCIS, Sara")
              | replace("JamesShipley", "SHIPLEY, James")
              | replace("AcmeLtd", "ACME LTD")
          %}

          <h2 class="govuk-heading-m">{{ displayName }}</h2>

          {# Corporate director guidance #}
          {% if director == "AcmeLtd" %}

            {{ govukDetails({
              summaryText: "Who can sign on behalf of a corporate director?",
              text: "For corporate directors, an authorised person must sign on their behalf. Provide the name and email address of the person signing for the company."
            }) }}

            {% set nameKey = "corporateSignerName" + loop.index0 %}

            {{ govukInput({
              label: {
                text: "Name of the person signing on behalf of " ~ displayName
              },
              hint: {
                text: "This must be the authorised person who will sign the application."
              },
              id: nameKey,
              name: nameKey,
              type: "text",
              autocomplete: "name",
              value: data[nameKey]
            }) }}

          {% endif %}

          {% set emailKey = "directorEmail" + loop.index0 %}

          {% set emailLabel =
            "Email address of the person signing on behalf of " ~ displayName
            if director == "AcmeLtd"
            else "Email address"
          %}

          {% set emailHint =
            "We’ll send the signing link to this email address."
            if director == "AcmeLtd"
            else "What is the email address for " ~ displayName ~ "?"
          %}

          {{ govukInput({
            label: { text: emailLabel },
            hint: { text: emailHint },
            id: emailKey,
            name: emailKey,
            type: "email",
            autocomplete: "email",
            spellcheck: false,
            value: data[emailKey]
          }) }}

        {% endfor %}

        {{ govukButton({
          text: "Continue"
        }) }}

      </form>

    </div>
  </div>
{% endblock %}